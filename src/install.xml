<?xml version="1.0" encoding="utf-8"?>

<!--
This file is part of "OCMOD Dir Fix" project and subject to the terms
and conditions defined in file "LICENSE.txt", which is part of this source
code package.
-->

<modification>
	<name>![underr] OCMOD Dir Fix</name>
	<code>ocmod-dir-fix</code>
	<version>1.0.0</version>
	<author>Andrii Burkatskyi aka underr</author>
	<link>https://www.opencart.com/index.php?route=marketplace/extension&amp;filter_member=ocmod.space</link>

	<file path="admin/controller/marketplace/install.php">
		<operation error="log">
  			<search>
				<![CDATA[if ($safe) {]]>
			</search>
			<add position="before">
				<![CDATA[					$safe = true;]]>
			</add>
		</operation>
		<operation error="log">
			<search>
				<![CDATA[if (is_dir($file) && !is_dir($path)) {]]>
			</search>
			<add position="before">
				<![CDATA[						if ($path == '') {
							$d = explode('/', DIR_APPLICATION);
							unset($app_root[count($d) - 2]);
							$app_root = implode('/', $d);
							$path = $d . $destination;
						}]]>
			</add>
		</operation>
	</file>
</modification>
